{% extends "admin/base.html" %}
{% load i18n static%}

{% block title %}{{ title }} | Hodowla z Wojciechowic{% endblock %}

{% block extrahead %}
    {{ block.super }}
    <link rel="stylesheet" type="text/css" href="{% static 'css/admin/admin_custom.css' %}">
    <script src="{% static 'js/admin_image_preview.js' %}"></script>
    <script src="{% static 'js/admin_mobile.js' %}"></script> 
    <link rel="icon" href="{% static 'logo/dog-logo.ico' %}" type="image/x-icon">
    <link rel="icon" href="{% static 'logo/dog-logo.png' %}" type="image/png">
    <link rel="apple-touch-icon" href="{% static 'logo/dog-logo.png' %}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    {% if not is_popup %}
        {# Prostsza logika - sprawdÅº czy jesteÅ› w admin panelu #}
        {% if request.resolver_match.namespace == 'admin' %}
            <a href="{% url 'admin:index' %}">Panel gÅ‚Ã³wny</a>
            {% if title and title != "Panel gÅ‚Ã³wny" %} â€º {{ title }}{% endif %}
        {% else %}
            {# Fallback dla innych przypadkÃ³w #}
            <a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
            {% if title %} â€º {{ title }}{% endif %}
        {% endif %}
    {% endif %}
</div>
{% endblock %}

{% block branding %}
<div style="display: flex; align-items: center;">
    <img src="{% static 'logo/dog-logo.png' %}" alt="Logo" 
         style="height: 40px; margin-right: 15px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));">
    <h1 id="site-name" style="margin: 0; font-size: 24px; font-weight: 600;">
        <a href="{% url 'admin:index' %}" 
           style="color: white; text-decoration: none; text-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            z Wojciechowic
        </a>
    </h1>
</div>
{% endblock %}

{% block nav-sidebar %}
<!-- Modern Floating Navbar -->
<div class="admin-modern-navbar">
    <div class="admin-navbar-content">
        <a href="{% url 'admin:index' %}" class="admin-navbar-brand">
            <img src="{% static 'logo/dog-logo.png' %}" alt="Logo" style="width: 32px; height: 32px; border-radius: 50%;">
            <span class="admin-brand-text">Admin</span>
        </a>
        
        <div class="admin-nav-items">
            {% if available_apps %}
                {% for app in available_apps %}
                    {% if app.name == "Main" or app.name == "Panel gÅ‚Ã³wny" %}
                        <div class="admin-nav-item">
                            <a href="#" class="admin-nav-link" title="Panel gÅ‚Ã³wny">
                                <span class="admin-nav-icon">âš™ï¸</span>
                                <span class="admin-nav-text">{% trans "Panel gÅ‚Ã³wny"%}</span>
                            </a>
                            {% if app.models %}
                                <div class="admin-nav-dropdown">
                                    {% for model in app.models %}
                                        {% if model.admin_url %}
                                            <div class="admin-dropdown-item-wrapper">
                                                <a href="{{ model.admin_url }}" class="admin-dropdown-link admin-dropdown-main">
                                                    {% if model.name == "Dogs" or model.name == "Psy" %}ğŸ•
                                                    {% elif model.name == "Puppies" or model.name == "SzczeniÄ™ta" %}ğŸ¶
                                                    {% elif model.name == "Reservations" or model.name == "Rezerwacje" %}ğŸ“…
                                                    {% elif model.name == "Strona O nas" %}ğŸ“„
                                                    {% elif model.name == "WiadomoÅ›ci kontaktowe" %}ğŸ’Œ
                                                    {% elif model.name == "Wpisy na blogu" %}ğŸ“
                                                    {% else %}ğŸ“„
                                                    {% endif %}
                                                    {{ model.name }}
                                                </a>
                                                {% if model.add_url %}
                                                    <a href="{{ model.add_url }}" class="admin-dropdown-add-btn" title="Dodaj {{ model.name }}">
                                                        +
                                                    </a>
                                                {% endif %}
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    {% endif %}
                {% endfor %}
            {% endif %}

            <!-- User Menu with Users model -->
            <div class="admin-nav-item">
                <a href="#" class="admin-nav-link" title="{{ user.get_username }}">
                    <span class="admin-nav-icon">ğŸ‘¤</span>
                </a>
                <div class="admin-nav-dropdown">
                    <a href="{% url 'admin:password_change' %}" class="admin-dropdown-link">
                        ğŸ”’ {% trans "ZmieÅ„ hasÅ‚o"%}
                    </a>
                    <a href="{% url 'admin:logout' %}" class="admin-dropdown-link">
                        ğŸšª {% trans "Wyloguj"%}
                    </a>
                    {% for app in available_apps %}
                        {% if app.name == "Authentication and Authorization" or app.name == "Uwierzytelnienie i autoryzacja" %}
                            {% for model in app.models %}
                                {% if model.name == "Users" or model.name == "UÅ¼ytkownicy" %}
                                    <div class="admin-dropdown-item-wrapper">
                                        <a href="{{ model.admin_url }}" class="admin-dropdown-link admin-dropdown-main">
                                            ğŸ‘¤ {{ model.name }}
                                        </a>
                                        {% if model.add_url %}
                                            <a href="{{ model.add_url }}" class="admin-dropdown-add-btn" title="Dodaj {{ model.name }}">
                                                +
                                            </a>
                                        {% endif %}
                                    </div>
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
            <div class="admin-nav-item">
                <a href="#" class="admin-nav-link" title="{% trans 'ZmieÅ„ jÄ™zyk' %}">
                    <span class="admin-nav-icon">
                        {% get_current_language as LANGUAGE_CODE %}
                        {% if LANGUAGE_CODE == 'pl' %}ğŸ‡µğŸ‡±{% else %}ğŸ‡¬ğŸ‡§{% endif %}
                    </span>
                </a>
                <div class="admin-nav-dropdown">
                    <form action="{% url 'set_language' %}" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="next" value="{{ request.get_full_path }}">
                        <input type="hidden" name="language" value="pl">
                        <button type="submit" class="admin-dropdown-link">ğŸ‡µğŸ‡± {% trans "Polski" %}</button>
                    </form>
                    <form action="{% url 'set_language' %}" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="next" value="{{ request.get_full_path }}">
                        <input type="hidden" name="language" value="en">
                        <button type="submit" class="admin-dropdown-link">ğŸ‡¬ğŸ‡§ {% trans "English" %}</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Przycisk hamburgera (dodaj w headerze) -->
<button id="adminMobileToggle" class="admin-mobile-toggle">
    <div class="hamburger-lines">
        <span></span>
        <span></span>
        <span></span>
    </div>
</button>

<!-- Mobile Menu Overlay (dodaj przed zamkniÄ™ciem body) -->
<div id="adminMobileMenu" class="admin-mobile-menu">
    <button id="adminMobileClose" class="admin-mobile-close">
        <i class="fas fa-times"></i>
    </button>
    
    <div class="admin-mobile-brand">
        <a href="/admin/" class="admin-brand-link">
            <img src="{% load static %}{% static 'logo/dog-logo.png' %}" alt="Logo">
            <span>Admin Panel</span>
        </a>
    </div>
    
    <div class="admin-mobile-nav-items">
        <div class="admin-mobile-nav-group">
            
            <div class="admin-mobile-nav-item">
                <a href="/admin/main/dog/" class="admin-mobile-nav-link">
                    ğŸ• {% trans "Psy"%}
                </a>
                <a href="/admin/main/dog/add/" class="admin-mobile-add-btn" title="Dodaj psa">+</a>
            </div>
            
            <div class="admin-mobile-nav-item">
                <a href="/admin/main/reservation/" class="admin-mobile-nav-link">
                    ğŸ“… {% trans "Rezerwacje"%}
                </a>
                <a href="/admin/main/reservation/add/" class="admin-mobile-add-btn" title="Dodaj rezerwacjÄ™">+</a>
            </div>
            
            <div class="admin-mobile-nav-item">
                <a href="/admin/main/aboutsections/" class="admin-mobile-nav-link">
                    ğŸ“„ {% trans "Sekcje O Nas"%}
                </a>
                <a href="/admin/main/aboutsections/add/" class="admin-mobile-add-btn" title="Dodaj sekcjÄ™">+</a>
            </div>
            
            <div class="admin-mobile-nav-item">
                <a href="/admin/main/puppy/" class="admin-mobile-nav-link">
                    ğŸ¶ {% trans "SzczeniÄ™ta"%}
                </a>
                <a href="/admin/main/puppy/add/" class="admin-mobile-add-btn" title="Dodaj szczeniÄ™">+</a>
            </div>
            
            <div class="admin-mobile-nav-item">
                <a href="/admin/main/contactmessage/" class="admin-mobile-nav-link">
                    ğŸ“§ {% trans "WiadomoÅ›ci kontaktowe"%}
                </a>
                <a href="/admin/main/contactmessage/add/" class="admin-mobile-add-btn" title="Dodaj wiadomoÅ›Ä‡">+</a>
            </div>
            
            <div class="admin-mobile-nav-item">
                <a href="/admin/main/blogpost/" class="admin-mobile-nav-link">
                    ğŸ“ {% trans "Wpisy na blogu"%}
                </a>
                <a href="/admin/main/blogpost/add/" class="admin-mobile-add-btn" title="Dodaj wpis">+</a>
            </div>
            
            <div class="admin-mobile-nav-item">
                <a href="/admin/auth/user/" class="admin-mobile-nav-link">
                    ğŸ‘¥ {% trans "UÅ¼ytkownicy"%}
                </a>
                <a href="/admin/auth/user/add/" class="admin-mobile-add-btn" title="Dodaj uÅ¼ytkownika">+</a>
            </div>
            
            <div class="admin-mobile-nav-item">
                <a href="/admin/password_change/" class="admin-mobile-nav-link">
                    ğŸ”’ {% trans "ZmieÅ„ hasÅ‚o"%}
                </a>
            </div>
            
            <div class="admin-mobile-nav-item">
                <a href="/admin/logout/" class="admin-mobile-nav-link">
                    ğŸšª {% trans "Wyloguj"%}
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block nav-global %}
<!-- UsuÅ„ globalnÄ… nawigacjÄ™ dla czystszego wyglÄ…du -->
{% endblock %}

{% block welcome-msg %}
    <div style="background: rgba(255,255,255,0.2); 
                padding: 10px 20px; 
                border-radius: 20px; 
                backdrop-filter: blur(10px);
                margin-left: 20px;">
        {% trans 'Welcome,' %}
        <strong>{% firstof user.get_short_name user.get_username %}</strong>
    </div>
{% endblock %}

{% block footer %}
<div id="footer" style="background: transparent; 
                        text-align: center; 
                        padding: 40px 20px 20px; 
                        color: #666; 
                        margin-top: 50px;">
    <p style="margin: 0; 
              font-size: 14px; 
              color: #888;
              text-shadow: 0 1px 2px rgba(255,255,255,0.8);">
        {% trans "ğŸ’™ Panel Administracyjny - Hodowla z Wojciechowic "%}
        <span style="opacity: 0.7;">| {% trans "ZarzÄ…dzaj z pasjÄ…"%}</span>
    </p>
</div>
{% endblock %}